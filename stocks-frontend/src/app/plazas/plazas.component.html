<div class="app">
  <aside class="sidebar">
    <div class="logo">PlazApp Admin</div>
    <nav class="nav">
      <a href="/">üè† Dashboard</a>
      <a href="/modulos">üß© M√≥dulos</a>
      <a href="/planes">üì¶ Planes</a>
      <a href="/plazas" class="active">üè¢ Plazas</a>
      <a href="/suscripciones">üîÅ Suscripciones</a>
    </nav>
    <div style="margin-top: auto; font-size: 13px; color: #cfcfcf">
      ¬© KodeHaus
    </div>
  </aside>

  <div class="container">
    <header class="header">
      <div style="margin-right: 12px; text-align: right">
        <div class="small">Admin Entidad de Gobierno</div>
      </div>
      <div class="avatar" title="Admin"></div>
    </header>
    <main class="content">
      <h2 style="margin-top: 6px; margin-bottom: 18px">Gesti√≥n de Plazas</h2>
      
      <div class="toolbar">
        <div class="small">Listado de plazas registradas</div>
        <button class="btn" (click)="toggleRegisterForm()">
          + Registrar Nueva Plaza
        </button>
      </div>
      @if(listaPlazas.length == 0){
        <h2 style="color: red">No hay plazas registradas</h2>
      }

      @else(){
        <table class="table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Ubicaci√≥n</th>
            <th>Plan</th>
            <th>Fecha adquisici√≥n</th>
            <th>M√≥dulos</th>
            <th>Dominio</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for(plaza of listaPlazas; track plaza.id){
            <tr>
              <td>{{plaza.nombre}}</td>
              <td>{{plaza.ciudad}}, {{plaza.departamento}}</td>
              <td>{{plaza.plan}}</td>
              <td>{{plaza.fechaCreacion	}}</td>
              <td>{{plaza.plan}}</td>
              <td>{{plaza.dominio}}</td>
              <td class="actions">
                <button (click)="showPlazaInfo(plaza.id)">üîé</button>
                <button (click)="toggleModifyForm(plaza.id)">‚úèÔ∏è</button>
                <button (click)="toggleDelete(plaza.id, plaza.nombre)">üóëÔ∏è</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
      }
      @if(showRegisterForm){
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-label="Registrar Plaza (ejemplo)">

        <form (ngSubmit)="crearPlaza()">
          <h3 style="margin-top: 0">Registrar Nueva Plaza</h3>
          <div class="form-row">
            <label>Nombre</label>
            <input class="input" name="nombre" [(ngModel)]="nuevaPlaza.nombre" placeholder="Nombre de la plaza" />
          </div>
          <div class="form-row">
            <label>Departamento</label
            ><input class="input" name="direccion" [(ngModel)]="nuevaPlaza.departamento" placeholder="Departamento" />
          </div>
          <div class="form-row">
            <label>Ciudad</label
            ><input class="input" name="direccion" [(ngModel)]="nuevaPlaza.ciudad" placeholder="Ciudad" />
          </div>
          <div class="form-row">
            <label>Direcci√≥n</label
            ><input class="input" name="direccion" [(ngModel)]="nuevaPlaza.direccion" placeholder="Direcci√≥n completa" />
          </div>
          <div class="form-row">
            <label>Contacto</label
            ><input class="input" name="contacto" [(ngModel)]="nuevaPlaza.contacto" placeholder="Email / tel√©fono" />
          </div>
          <div class="form-row">
            <label>Plan</label>
            <select class="input" [(ngModel)]="selectedPlanId" name="planId" required>
              <option value="0" disabled>Seleccione un plan</option>
              <option *ngFor="let plan of planes" [value]="plan.id">
                {{ plan.tipo }} - {{ plan.numModulos }} m√≥dulos - {{ plan.numUsuarios }} usuarios
              </option>
            </select>
          </div>
          <div class="form-row"><label>Dominio (autogenerado)</label><input class="input" placeholder="plazanombre.token"></div>
          <div
            style="
              display: flex;
              gap: 8px;
              justify-content: flex-end;
              margin-top: 12px;
            ">
            <button class="btn" style="background: #e0e0e0; color: #333" (click)="toggleRegisterForm()">Cancelar</button>
            <button type="submit" class="btn">Crear</button>
          </div>
        </form>
      </div>
      }
      
      @if(showMofidyForm){
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-label="Registrar Plaza (ejemplo)">

        <form (ngSubmit)="actualizarPlaza()">
          <h3 style="margin-top: 0">Modificar Plaza</h3>
          <div class="form-row">
            <label>Nombre</label>
            <input class="input" name="nombre" [(ngModel)]="nuevaPlaza.nombre" placeholder="Nombre de la plaza" />
          </div>
          <div class="form-row">
            <label>Departamento</label
            ><input class="input" name="departamento" [(ngModel)]="nuevaPlaza.departamento" placeholder="Departamento" />
          </div>
          <div class="form-row">
            <label>Ciudad</label
            ><input class="input" name="ciudad" [(ngModel)]="nuevaPlaza.ciudad" placeholder="Ciudad" />
          </div>
          <div class="form-row">
            <label>Direcci√≥n</label
            ><input class="input" name="direccion" [(ngModel)]="nuevaPlaza.direccion" placeholder="Direcci√≥n completa" />
          </div>
          <div class="form-row">
            <label>Contacto</label
            ><input class="input" name="contacto" [(ngModel)]="nuevaPlaza.contacto" placeholder="Email / tel√©fono" />
          </div>
          <div class="form-row">
            <label>Plan</label
            ><select>
              <option>B√°sico</option>
              <option>Avanzado</option>
              <option>Premium</option>
            </select>
          </div>
          <div
            style="
              display: flex;
              gap: 8px;
              justify-content: flex-end;
              margin-top: 12px;
            ">
            <button class="btn" style="background: #e0e0e0; color: #333" (click)="toggleModifyForm(null)">Cancelar</button>
            <button type="submit" class="btn">Actualizar</button>
          </div>
        </form>
      </div>
      } 
      
      @if(showDeleteConfirm){
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-label="Registrar Plaza (ejemplo)"
      >
        <h3 style="margin-top: 0">Eliminar la plaza {{DeleteName}}?</h3>
        <div
          style="
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 12px;
          "
        >
          <button
            class="btn"style="background: #e0e0e0; color: #333" (click)="toggleDelete(null, '')">Cancelar
          </button>
          <button class="btn" (click)="deletePlaza()">Confirmar</button>
        </div>
      </div>
      }

      @if(showInfoPanel){
      <div
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-label="Registrar Plaza (ejemplo)">
        <h3 style="margin-top: 0">Informacion de Plaza</h3>
        <div>
          <h4>Nombre</h4>
          <p>{{plazaInfo.nombre}}</p>
        </div>
        <div>
          <h4>Departamento</h4>
          <p>{{plazaInfo.departamento}}</p>
        </div>
        <div>
          <h4>Ciudad</h4>
          <p>{{plazaInfo.ciudad}}</p>
        </div>
        <div>
          <h4>Direcci√≥n</h4>
          <p>{{plazaInfo.direccion}}</p>
        </div>
        <div>
          <h4>Contacto(telefono/correo)</h4>
          <p>{{plazaInfo.contacto}}</p>
        </div>
        <div>
          <h4>Dominio</h4>
          <p>{{plazaInfo.dominio}}</p>
        </div>
        <div>
          <h4>Fecha de registro</h4>
          <p>{{plazaInfo.fechaCreacion}}</p>
        </div>
        <div
            style="
              display: flex;
              gap: 8px;
              justify-content: flex-end;
              margin-top: 12px;
            ">
            <button class="btn" style="background: #e0e0e0; color: #333" (click)="showPlazaInfo(null)">Cerrar</button>
          </div>
        </div>
      }
    </main>
  </div>
</div>
